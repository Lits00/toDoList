(()=>{"use strict";class e{constructor(e,t,s=!1){this.name=e,this.dueDate=t,this.status=s}}class t{constructor(e,t=[]){this.name=e,this.tasks=t}}const s=new class{constructor(){this.inbox=[],this.today=[],this.weekly=[],this.projects=[]}addTask(e){this.checkList(e)?alert("Task already exist."):(this.inbox.push(e),this.inbox.sort(((e,t)=>this.sortDate(e.dueDate,t.dueDate))),this.today=this.inbox.filter((e=>this.dueToday(e.dueDate))),this.weekly=this.inbox.filter((e=>this.weeklyDue(e.dueDate))))}updateTask(e,t){const s=this.inbox.findIndex((s=>s.name===e&&s.dueDate===t)),a=this.inbox[s].status;this.inbox[s].status=!a}deleteTask(e,t){const s=this.inbox.findIndex((s=>s.name===e&&s.dueDate===t));this.inbox.splice(s,1),this.today=this.inbox.filter((e=>this.dueToday(e.dueDate))),this.weekly=this.inbox.filter((e=>this.weeklyDue(e.dueDate)))}addProject(e){this.checkProject(e)?alert("Project name already exist!"):this.projects.push(e)}deleteProject(e){const t=this.projects.findIndex((t=>t.name===e));this.projects.splice(t,1)}addProjectTask(e,t){const s=this.getProject(e);this.checkProjectTask(e,t)?alert("Task already exist."):(s.tasks.push(t),s.tasks.sort(((e,t)=>this.sortDate(e.dueDate,t.dueDate))))}updateProjectTask(e,t,s){const a=this.getProject(e),n=a.tasks.findIndex((e=>e.name===t&&e.dueDate===s)),d=a.tasks[n].status;a.tasks[n].status=!d}deleteProjectTask(e,t,s){const a=this.getProject(e),n=a.tasks.findIndex((e=>e.name===t&&e.dueDate===s));a.tasks.splice(n,1)}getProject(e){const t=this.projects.findIndex((t=>t.name===e));return this.projects[t]}sortDate(e,t){return new Date(e).valueOf()-new Date(t).valueOf()}dueToday(e){const t=new Date;return new Date(e).toDateString()===t.toDateString()}weeklyDue(e){const t=new Date,s=t.getDay(),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()-s),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()+(7-s)),d=new Date(e);return d>=a&&d<=n}checkList(e){return this.inbox.some((t=>t.name===e.name&&t.dueDate===e.dueDate))}checkProject(e){return this.projects.some((t=>t.name===e.name))}checkProjectTask(e,t){return this.getProject(e).tasks.some((e=>e.name===t.name&&e.dueDate===t.dueDate))}},a=()=>{document.getElementById("task-name").value="",document.getElementById("task-date").value=""},n=()=>{localStorage.setItem("todo",JSON.stringify(s))},d=e=>{const t=new Date(e);return`${["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()]} ${t.getDate().toString().padStart(2,"0")}, ${t.getFullYear().toString()}`},c=(e,t,s)=>{const a=document.getElementById("task-container"),n=document.createElement("div");n.classList.add("task","task-file","d-flex");const d=document.createElement("input");d.type="checkbox",d.name="status",d.classList.add("status");const c=document.createElement("div");c.classList.add("task-details","d-flex");const o=document.createElement("p");o.textContent=e;const i=document.createElement("p");i.textContent=t,s?(o.classList.add("taskTitle","crossed"),i.classList.add("taskDuedate","crossed"),d.checked=!0):(o.classList.add("taskTitle"),i.classList.add("taskDuedate"),d.checked=!1);const l=document.createElement("button");l.classList.add("deleteTask","no-margin"),l.innerHTML="&times;",a.appendChild(n),n.append(d,c,l),c.append(o,i)},o=()=>{const e=document.getElementById("content-name");switch(document.getElementById("task-container").innerHTML="",e.textContent){case"Inbox":s.inbox.forEach((e=>c(e.name,e.dueDate,e.status)));break;case"Today":s.today.forEach((e=>c(e.name,e.dueDate,e.status)));break;case"This Week":s.weekly.forEach((e=>c(e.name,e.dueDate,e.status)))}},i=()=>{document.getElementById("projects").innerHTML="",s.projects.forEach((e=>(e=>{const t=document.getElementById("projects"),s=document.createElement("button");s.textContent=e,t.appendChild(s)})(e.name)))},l=e=>{document.getElementById("task-container").innerHTML="",s.getProject(e).tasks.forEach((e=>c(e.name,e.dueDate,e.status)))};(()=>{const c=document.getElementById("menu"),r=document.getElementById("inbox"),u=document.getElementById("today"),m=document.getElementById("weekly"),k=document.getElementById("content-name"),h=document.getElementById("task-container"),g=document.getElementById("add-task-form"),y=document.getElementById("add-task-popup"),L=document.getElementById("add-task-btn"),v=document.getElementById("cancel-task-btn"),E=document.getElementById("projects"),p=document.getElementById("add-proj-popup"),x=document.getElementById("add-proj-form"),D=document.getElementById("add-proj-btn"),b=document.getElementById("cancel-proj-btn"),I=document.getElementById("delete-project");(()=>{const t=JSON.parse(localStorage.getItem("todo"));t?(t.inbox.map((t=>s.addTask((t=>new e(t.name,t.dueDate))(t)))),t.projects.map((e=>s.addProject(e)))):(s.inbox=[],s.today=[],s.weekly=[],s.projects=[])})(),o(),i(),c.addEventListener("click",(()=>{const e=document.getElementById("container"),t=document.getElementById("menu-list");e.classList.toggle("set-container"),t.classList.toggle("hidden")})),r.addEventListener("click",(()=>{j()})),u.addEventListener("click",(()=>{k.textContent="Today",I.classList.add("hidden"),T(),o()})),m.addEventListener("click",(()=>{k.textContent="This Week",I.classList.add("hidden"),T(),o()})),y.addEventListener("click",(()=>{y.classList.remove("active"),y.classList.toggle("button-active"),g.classList.remove("hidden"),g.classList.add("active")})),L.addEventListener("click",(()=>{const t=k.textContent;f(),"Inbox"===t?((()=>{const t=document.getElementById("task-name").value,c=document.getElementById("task-date").value;if(""===t||""===c)alert("Please fill-up all required information."),a();else{const o=new e(t,d(c));s.addTask(o),n(),a()}})(),o()):((t=>{const c=document.getElementById("task-name").value,o=document.getElementById("task-date").value;if(""===c||""===o)alert("Please fill-up all required information."),a();else{const i=new e(c,d(o));s.addProjectTask(t,i),n(),a()}})(t),l(t))})),v.addEventListener("click",(()=>{f()})),h.addEventListener("click",(e=>{if(e.target.classList.contains("status")){const d=e.target.nextElementSibling,c=d.querySelector(".taskTitle").textContent,i=d.querySelector(".taskDuedate").textContent,r=k.textContent;"Inbox"===r||"Today"===r||"This Week"===r?(t=c,a=i,s.updateTask(t,a),n(),o()):((e,t,a)=>{s.updateProjectTask(e,t,a),n(),l(e)})(r,c,i)}else if(e.target.classList.contains("deleteTask")){const t=e.target.closest(".task").querySelector(".task-details"),a=t.querySelector(".taskTitle").textContent,d=t.querySelector(".taskDuedate").textContent,c=k.textContent;"Inbox"===c||"Today"===c||"This Week"===c?((e,t)=>{s.deleteTask(e,t),n(),o()})(a,d):((e,t,a)=>{s.deleteProjectTask(e,t,a),n(),l(e)})(c,a,d)}var t,a})),p.addEventListener("click",(()=>{p.classList.remove("active"),p.classList.toggle("button-active"),x.classList.remove("hidden"),x.classList.add("active")})),D.addEventListener("click",(()=>{(()=>{const e=document.getElementById("proj-name").value;if(""===e)alert("Project name can't be empty!");else{const a=new t(e);s.addProject(a),n(),document.getElementById("proj-name").value=""}})(),B(),i()})),b.addEventListener("click",(()=>{B()})),I.addEventListener("click",(()=>{var e;e=k.textContent,s.deleteProject(e),n(),i(),j()})),E.addEventListener("click",(e=>{if("BUTTON"===e.target.tagName){const t=e.target.textContent;k.textContent=t,I.classList.contains("hidden")&&I.classList.remove("hidden"),l(t),y.classList.add("active"),y.classList.remove("hidden"),g.classList.remove("active"),g.classList.add("hidden"),y.classList.contains("button-active")&&y.classList.toggle("button-active")}}));const j=()=>{k.textContent="Inbox",y.classList.add("active"),y.classList.remove("hidden"),g.classList.remove("active"),g.classList.add("hidden"),I.classList.add("hidden"),y.classList.contains("button-active")&&y.classList.toggle("button-active"),o()},T=()=>{y.classList.add("hidden"),y.classList.remove("active"),g.classList.remove("active"),g.classList.add("hidden")},f=()=>{y.classList.remove("active"),y.classList.toggle("button-active"),g.classList.remove("active"),g.classList.add("hidden")},B=()=>{p.classList.remove("active"),p.classList.toggle("button-active"),x.classList.remove("active"),x.classList.add("hidden")}})()})();